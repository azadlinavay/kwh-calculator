<!DOCTYPE html>
<html lang="ku" id="html-root" dir="rtl">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ø¨Ú˜Ù…ÛØ±Û Ú©ÛŒÙ„ÙˆÙˆØ§ØªØ§Ù† | KWh Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in-up {
            animation: fadeInUp 0.5s ease-out forwards;
        }
    </style>
</head>

<body
    class="min-h-screen bg-gradient-to-br from-blue-100 via-purple-100 to-pink-100 flex flex-col items-center justify-center p-0 md:p-6 transition-colors duration-500">
    <div id="container"
        class="bg-white shadow-2xl rounded-3xl p-4 md:p-10 w-full max-w-5xl transition hover:scale-[1.01] duration-300 flex flex-col md:flex-row gap-8 md:gap-12 border border-purple-200">
        <div class="flex-1 min-w-[320px]">
            <div class="flex justify-between items-center mb-8">
                <h1 id="title" class="text-3xl md:text-4xl font-extrabold text-purple-700 tracking-tight drop-shadow">ğŸ”Œ
                    Ø¨Ú˜Ù…ÛØ±Û Ú©ÛŒÙ„Ùˆ ÙˆØ§ØªØ§Ù†</h1>
                <select id="lang-select" onchange="setLang(this.value)"
                    class="text-sm bg-purple-100 text-purple-800 px-3 py-1 rounded-md hover:bg-purple-200 transition focus:outline-none focus:ring-2 focus:ring-purple-400 border border-purple-300">
                    <option value="ku">Ú©ÙˆØ±Ø¯ÛŒ</option>
                    <option value="en">EN</option>
                    <option value="ar">Ø¹Ø±Ø¨ÙŠ</option>
                </select>
            </div>
            <div class="mb-6">
                <label id="power-label" class="block text-gray-700 font-semibold mb-1">â€ŒÙˆØ²Û• (ÙˆØ§Øª)</label>
                <input id="power" type="number" placeholder="Ù†Ù…ÙˆÙˆÙ†Û•: 1000"
                    class="w-full mb-4 p-3 rounded-xl border border-purple-200 focus:outline-none focus:ring-2 focus:ring-purple-500 transition text-right bg-purple-50 placeholder-purple-300" />
            </div>
            <!-- Tabs -->
            <div>
                <div class="flex mb-4 space-x-2 space-x-reverse" id="tabs">
                    <button
                        class="tab-button bg-purple-100 text-purple-700 px-3 py-1 rounded-lg font-semibold hover:bg-purple-200 focus:ring-2 focus:ring-purple-400 transition"
                        onclick="switchTab('hm')">Ø¯Û•Ù…Ú˜Ù…ÛØ± Ùˆ Ø®ÙˆÙ„Û•Ú©</button>
                    <button
                        class="tab-button bg-purple-100 text-purple-700 px-3 py-1 rounded-lg font-semibold hover:bg-purple-200 focus:ring-2 focus:ring-purple-400 transition"
                        onclick="switchTab('days')">Ø±Û†Ú˜</button>
                    <button
                        class="tab-button bg-purple-100 text-purple-700 px-3 py-1 rounded-lg font-semibold hover:bg-purple-200 focus:ring-2 focus:ring-purple-400 transition"
                        onclick="switchTab('months')">Ù‡Û•ÛŒÚ¤</button>
                    <button
                        class="tab-button bg-purple-100 text-purple-700 px-3 py-1 rounded-lg font-semibold hover:bg-purple-200 focus:ring-2 focus:ring-purple-400 transition"
                        onclick="switchTab('years')">Ø³Ø§Ù„</button>
                </div>
                <!-- Tab Content -->
                <div id="hm" class="tab-content space-y-4">
                    <div>
                        <label id="hours-label" class="block text-gray-700 font-medium">Ø¯Û•Ù… (Ø¯Û•Ù…Ú˜Ù…ÛØ±)</label>
                        <input id="hours" type="number"
                            class="w-full mt-1 p-3 rounded-lg border border-gray-300 text-right" />
                    </div>
                    <div>
                        <label id="minutes-label" class="block text-gray-700 font-medium">Ø¯Û•Ù… (Ø®ÙˆÙ„Û•Ú©)</label>
                        <input id="minutes" type="number"
                            class="w-full mt-1 p-3 rounded-lg border border-gray-300 text-right" />
                    </div>
                </div>

                <div id="days" class="tab-content space-y-4 hidden">
                    <div>
                        <label class="block text-gray-700 font-medium">Ø¯Û•Ù… (Ø±Û†Ú˜)</label>
                        <input id="days-input" type="number"
                            class="w-full mt-1 p-3 rounded-lg border border-gray-300 text-right" />
                    </div>
                </div>

                <div id="months" class="tab-content space-y-4 hidden">
                    <div>
                        <label class="block text-gray-700 font-medium">Ø¯Û•Ù… (Ù‡Û•ÛŒÚ¤)</label>
                        <input id="months-input" type="number"
                            class="w-full mt-1 p-3 rounded-lg border border-gray-300 text-right" />
                    </div>
                </div>

                <div id="years" class="tab-content space-y-4 hidden">
                    <div>
                        <label class="block text-gray-700 font-medium">Ø¯Û•Ù… (Ø³Ø§Ù„)</label>
                        <input id="years-input" type="number"
                            class="w-full mt-1 p-3 rounded-lg border border-gray-300 text-right" />
                    </div>
                </div>
            </div>

            <div id="result" class="text-center text-lg font-semibold mt-6 hidden fade-in-up rounded-xl p-4"></div>
        </div>
        <div class="flex-1 min-w-[320px]">
            <h2 id="devices-title"
                class="text-xl md:text-2xl font-extrabold text-purple-700 mb-4 flex items-center gap-2 drop-shadow-sm">
                <span>ğŸ§®</span><span>Devices & Scenarios</span>
            </h2>
            <div class="mb-4">
                <div id="tariff-info"
                    class="bg-gradient-to-r from-purple-100 to-pink-100 border border-purple-200 rounded-2xl p-4 text-sm text-purple-900 leading-relaxed shadow-sm">
                    <!-- Tariff info will be set by JS translation -->
                </div>
            </div>
            <div id="devices-list" class="space-y-4"></div>
            <button id="add-device-btn" onclick="addDevice()"
                class="mt-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white px-4 py-3 rounded-2xl shadow-lg hover:from-purple-600 hover:to-pink-600 transition font-bold w-full text-lg flex items-center justify-center gap-2">
                <span class="text-xl">ï¼‹</span><span id="add-device-label">Add Device</span>
            </button>
            <div id="devices-summary" class="mt-8 text-purple-800 font-bold text-lg"></div>
        </div>
    </div>
    <footer
        class="mt-8 text-gray-600 text-sm text-center w-full py-4 bg-white bg-opacity-70 border-t border-purple-100">
        <span id="footer-made">Ù‡Ø§ØªÛŒÛ• Ø¯Ø±ÙˆØ³ØªÚ©Ø±Ù† Ú˜ Ù„Ø§ÛŒÛ</span> <span class="font-semibold text-purple-700">
            <a href="https://github.com/azadlinavay" target="_blank">Ø¦Ø§Ø²Ø§Ø¯ Ù„ÛŒÙ†Ø§Ú¤Ø§ÛŒ</a>
        </span>
    </footer>

    <script>
        let currentLang = localStorage.getItem('lang') || 'ku';
        let currentTab = 'hm';

        const translations = {
            en: {
                title: 'ğŸ”Œ kWh Calculator',
                power: 'Power (Watts)',
                hours: 'Time (Hours)',
                minutes: 'Time (Minutes)',
                days: 'Time (Days)',
                months: 'Time (Months)',
                years: 'Time (Years)',
                hmTab: 'Hour & Minute',
                daysTab: 'Days',
                monthsTab: 'Months',
                yearsTab: 'Years',
                result: (val) => `âš¡ Energy: ${val} kWh`,
                error: 'âš ï¸ Please enter valid numbers!',
                dir: 'ltr',
                align: 'text-left',
                deviceName: 'Device name',
                powerShort: 'Power (W)',
                hoursShort: 'Hours/day',
                daysShort: 'Days',
                monthsShort: 'Months',
                kwhLabel: 'kWh',
                totalKwh: 'Total kWh',
                totalCost: 'Total Cost',
                addDevice: 'Add Device',
                devicesTitle: 'Devices & Scenarios',
                made: 'Made by',
                devicePlaceholder: 'e.g. Fridge',
                powerPlaceholder: 'e.g. 150',
                hoursPlaceholder: 'e.g. 8',
                daysPlaceholder: 'e.g. 30',
                monthsPlaceholder: 'e.g. 1',
                remove: 'Remove',
            },
            ku: {
                title: 'ğŸ”Œ Ø¨Ú˜Ù…ÛØ±Û Ú©ÛŒÙ„Ùˆ ÙˆØ§ØªØ§Ù†',
                power: 'â€ŒÙˆØ²Û• (ÙˆØ§Øª)',
                hours: 'Ø¯Û•Ù… (Ø¯Û•Ù…Ú˜Ù…ÛØ±)',
                minutes: 'Ø¯Û•Ù… (Ø®ÙˆÙ„Û•Ú©)',
                days: 'Ø¯Û•Ù… (Ø±Û†Ú˜)',
                months: 'Ø¯Û•Ù… (Ù‡Û•ÛŒÚ¤)',
                years: 'Ø¯Û•Ù… (Ø³Ø§Ù„)',
                hmTab: 'Ø¯Û•Ù…Ú˜Ù…ÛØ± Ùˆ Ø®ÙˆÙ„Û•Ú©',
                daysTab: 'Ø±Û†Ú˜',
                monthsTab: 'Ù‡Û•ÛŒÚ¤',
                yearsTab: 'Ø³Ø§Ù„',
                result: (val) => `âš¡ ÙˆØ²Û•: ${val} Ú©ÛŒÙ„ÙˆÙˆØ§Øª-Ø¯Û•Ù…Ú˜Ù…ÛØ±`,
                error: 'âš ï¸ Ù‡ÛŒÚ¤ÛŒÛ• Ú˜Ù…Ø§Ø±ÛÙ† Ø¯Ø±ÙˆØ³Øª Ø¨Ù†Ú¤ÛŒØ³Û•!',
                dir: 'rtl',
                align: 'text-right',
                deviceName: 'Ù†Ø§Ú¤Û Ø¦Ø§Ù…ÛŒØ±Û•ÛŒ',
                powerShort: 'ÙˆØ²Û• (ÙˆØ§Øª)',
                hoursShort: 'Ø¯Û•Ù…/Ø±Û†Ú˜',
                daysShort: 'Ø±Û†Ú˜',
                monthsShort: 'Ù‡Û•ÛŒÚ¤',
                kwhLabel: 'Ú©ÛŒÙ„ÙˆÙˆØ§Øª-Ø¯Û•Ù…Ú˜Ù…ÛØ±',
                totalKwh: 'Ú©Û†ÛŒÛ Ú¯Ø´ØªÛŒ Ú©ÛŒÙ„ÙˆÙˆØ§Øª',
                totalCost: 'Ø¨Ù‡Ø§ÛŒÛ Ú¯Ø´ØªÛŒ',
                addDevice: 'Ø²ÛØ¯Û•Ú©Ø±Ù†Ø§ Ø¦Ø§Ù…ÛŒØ±Û•ÛŒ',
                devicesTitle: 'Ø¦Ø§Ù…ÛŒØ±Û• Ùˆ Ø³ÛŒÙ†Ø§Ø±ÛŒÙˆ',
                made: 'Ù‡Ø§ØªÛŒÛ• Ú¯Û•Ø´Û•Ù¾ÛØ¯Ø§Ù† Ú˜ Ù„Ø§ÛŒÛ',
                devicePlaceholder: 'Ù†Ù…ÙˆÙˆÙ†Û•: Ø³Û•Ø±Ù…Ø§ÙˆÛ•Ø±',
                powerPlaceholder: 'Ù†Ù…ÙˆÙˆÙ†Û•: Ù¡Ù¥Ù ',
                hoursPlaceholder: 'Ù†Ù…ÙˆÙˆÙ†Û•: Ù¨',
                daysPlaceholder: 'Ù†Ù…ÙˆÙˆÙ†Û•: Ù£Ù ',
                monthsPlaceholder: 'Ù†Ù…ÙˆÙˆÙ†Û•: Ù¡',
                remove: 'Ú˜ÛØ¨Ø±Ù†',
            },
            ar: {
                title: 'ğŸ”Œ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙƒÙŠÙ„Ùˆ ÙˆØ§Ø·',
                power: 'Ø§Ù„Ù‚Ø¯Ø±Ø© (ÙˆØ§Ø·)',
                hours: 'Ø§Ù„ÙˆÙ‚Øª (Ø³Ø§Ø¹Ø§Øª)',
                minutes: 'Ø§Ù„ÙˆÙ‚Øª (Ø¯Ù‚Ø§Ø¦Ù‚)',
                days: 'Ø§Ù„ÙˆÙ‚Øª (Ø£ÙŠØ§Ù…)',
                months: 'Ø§Ù„ÙˆÙ‚Øª (Ø£Ø´Ù‡Ø±)',
                years: 'Ø§Ù„ÙˆÙ‚Øª (Ø³Ù†ÙˆØ§Øª)',
                hmTab: 'Ø³Ø§Ø¹Ø§Øª ÙˆØ¯Ù‚Ø§Ø¦Ù‚',
                daysTab: 'Ø£ÙŠØ§Ù…',
                monthsTab: 'Ø£Ø´Ù‡Ø±',
                yearsTab: 'Ø³Ù†ÙˆØ§Øª',
                result: (val) => `âš¡ Ø§Ù„Ø·Ø§Ù‚Ø©: ${val} ÙƒÙŠÙ„Ùˆ ÙˆØ§Ø·-Ø³Ø§Ø¹Ø©`,
                error: 'âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø£Ø±Ù‚Ø§Ù… ØµØ­ÙŠØ­Ø©!',
                dir: 'rtl',
                align: 'text-right',
                deviceName: 'Ø§Ø³Ù… Ø§Ù„Ø¬Ù‡Ø§Ø²',
                powerShort: 'Ø§Ù„Ù‚Ø¯Ø±Ø© (ÙˆØ§Ø·)',
                hoursShort: 'Ø³Ø§Ø¹Ø§Øª/ÙŠÙˆÙ…',
                daysShort: 'Ø£ÙŠØ§Ù…',
                monthsShort: 'Ø£Ø´Ù‡Ø±',
                kwhLabel: 'ÙƒÙŠÙ„Ùˆ ÙˆØ§Ø·-Ø³Ø§Ø¹Ø©',
                totalKwh: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ùƒ.Ùˆ.Ø³',
                totalCost: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙƒÙ„ÙØ©',
                addDevice: 'Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø§Ø²',
                devicesTitle: 'Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© ÙˆØ§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª',
                made: 'ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙˆØ§Ø³Ø·Ø©',
                devicePlaceholder: 'Ù…Ø«Ø§Ù„: Ø«Ù„Ø§Ø¬Ø©',
                powerPlaceholder: 'Ù…Ø«Ø§Ù„: Ù¡Ù¥Ù ',
                hoursPlaceholder: 'Ù…Ø«Ø§Ù„: Ù¨',
                daysPlaceholder: 'Ù…Ø«Ø§Ù„: Ù£Ù ',
                monthsPlaceholder: 'Ù…Ø«Ø§Ù„: Ù¡',
                remove: 'Ø­Ø°Ù',
            }
        };

        const tariffDescriptions = {
            en: `Residential Tariff (IQD/kWh):<br>
                <span class='block'>0-400 kWh: <b>72</b></span>
                <span class='block'>401-800 kWh: <b>108</b></span>
                <span class='block'>801-1200 kWh: <b>175</b></span>
                <span class='block'>1201-1600 kWh: <b>265</b></span>
                <span class='block'>1601+ kWh: <b>350</b></span><br>
                <span class='block mt-1'>The price is calculated in blocks. For example, if you use 900 kWh: the first 400 are at 72 IQD, the next 400 at 108 IQD, and the last 100 at 175 IQD.</span>`,
            ku: `Ø¨Ù‡Ø§ÛŒÛ Ú©Ø§Ø±Û•Ø¨Û (IQD/Ú©ÛŒÙ„ÙˆÙˆØ§Øª-Ø¯Û•Ù…Ú˜Ù…ÛØ±):<br>
                <span class='block'>Ù -Ù¤Ù Ù : <b>Ù§Ù¢</b></span>
                <span class='block'>Ù¤Ù Ù¡-Ù¨Ù Ù : <b>Ù¡Ù Ù¨</b></span>
                <span class='block'>Ù¨Ù Ù¡-Ù¡Ù¢Ù Ù : <b>Ù¡Ù§Ù¥</b></span>
                <span class='block'>Ù¡Ù¢Ù Ù¡-Ù¡Ù¦Ù Ù : <b>Ù¢Ù¦Ù¥</b></span>
                <span class='block'>Ù¡Ù¦Ù Ù¡+ : <b>Ù£Ù¥Ù </b></span><br>
                <span class='block mt-1'>Ø¨Ù‡Ø§ÛŒÛ Ú©Ø§Ø±Û•Ø¨Û Ø¨ Ù‚Û•Ø¨Ø§Ø±Û• Ø¯Ù‡ÛØªÛ• Ù‡Ú˜Ù…Ø§Ø±ØªÙ†. Ø¨Û† Ù†Ù…ÙˆÙˆÙ†Û• Ø¦Û•Ú¯Û•Ø± Ù©Ù Ù  Ú©ÛŒÙ„ÙˆÙˆØ§Øª Ø¨Ú©Ø§Ø±Ø¨ÛŒÙ†ÛŒØª: Ø¦ÛÚ©Û•Ù… Ù¤Ù Ù  Ø¨ Ù§Ù¢ IQDØŒ Ø¯ÙˆÙˆÛ•Ù… Ù¤Ù Ù  Ø¨ Ù¡Ù Ù¨ IQDØŒ Ùˆ Ù¡Ù Ù ÛŒ Ø¯ÙˆÛŒÙ…Ø§Ù‡ÛŒ Ø¨ Ù¡Ù§Ù¥ IQD.</span>`,
            ar: `ØªØ¹Ø±ÙØ© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡ Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ© (Ø¯ÙŠÙ†Ø§Ø±/ÙƒÙŠÙ„Ùˆ ÙˆØ§Ø·-Ø³Ø§Ø¹Ø©):<br>
                <span class='block'>Ù -Ù¤Ù Ù : <b>Ù§Ù¢</b></span>
                <span class='block'>Ù¤Ù Ù¡-Ù¨Ù Ù : <b>Ù¡Ù Ù¨</b></span>
                <span class='block'>Ù¨Ù Ù¡-Ù¡Ù¢Ù Ù : <b>Ù¡Ù§Ù¥</b></span>
                <span class='block'>Ù¡Ù¢Ù Ù¡-Ù¡Ù¦Ù Ù : <b>Ù¢Ù¦Ù¥</b></span>
                <span class='block'>Ù¡Ù¦Ù Ù¡+ : <b>Ù£Ù¥Ù </b></span><br>
                <span class='block mt-1'>ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø­Ø³Ø¨ Ø§Ù„Ø´Ø±Ø§Ø¦Ø­. Ù…Ø«Ù„Ø§Ù‹ Ø¥Ø°Ø§ Ø§Ø³ØªÙ‡Ù„ÙƒØª Ù©Ù Ù  ÙƒÙŠÙ„Ùˆ ÙˆØ§Ø·: Ø£ÙˆÙ„ Ù¤Ù Ù  Ø¨Ø³Ø¹Ø± Ù§Ù¢ Ø¯ÙŠÙ†Ø§Ø±ØŒ ÙˆØ§Ù„Ø«Ø§Ù†ÙŠØ© Ù¤Ù Ù  Ø¨Ø³Ø¹Ø± Ù¡Ù Ù¨ Ø¯ÙŠÙ†Ø§Ø±ØŒ ÙˆØ¢Ø®Ø± Ù¡Ù Ù  Ø¨Ø³Ø¹Ø± Ù¡Ù§Ù¥ Ø¯ÙŠÙ†Ø§Ø±.</span>`
        };

        function applyTranslation() {
            const t = translations[currentLang];

            document.getElementById('html-root').setAttribute('dir', t.dir);
            document.getElementById('html-root').setAttribute('lang', currentLang);
            document.getElementById('container').classList.remove('text-left', 'text-right');
            document.getElementById('container').classList.add(t.align);

            document.getElementById('title').textContent = t.title;
            document.getElementById('power-label').textContent = t.power;
            document.getElementById('hours-label').textContent = t.hours;
            document.getElementById('minutes-label').textContent = t.minutes;

            const tabButtons = document.querySelectorAll('.tab-button');
            [t.hmTab, t.daysTab, t.monthsTab, t.yearsTab].forEach((label, i) => {
                if (tabButtons[i]) tabButtons[i].textContent = label;
            });

            document.querySelector('#days label').textContent = t.days;
            document.querySelector('#months label').textContent = t.months;
            document.querySelector('#years label').textContent = t.years;

            document.getElementById('devices-title').textContent = `ğŸ§® ${t.devicesTitle}`;
            document.getElementById('add-device-label').textContent = t.addDevice;
            document.getElementById('footer-made').textContent = t.made;
            document.getElementById('add-device-btn').title = t.addDevice;

            const dirClass = t.dir === 'rtl' ? 'text-right' : 'text-left';
            document.querySelectorAll('input').forEach(input => {
                input.classList.remove('text-right', 'text-left');
                input.classList.add(dirClass);
            });

            document.getElementById('result').classList.add('hidden');
            updateTariffInfo();
            renderDevices();
        }

        function setLang(lang) {
            currentLang = lang;
            localStorage.setItem('lang', currentLang);
            applyTranslation();
            updateLangSelect();
        }

        function updateLangSelect() {
            const select = document.getElementById('lang-select');
            if (select) select.value = currentLang;
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(tab).classList.remove('hidden');
            currentTab = tab;
            calculateKwh(); // auto-calculate
        }

        function calculateKwh() {
            const power = parseFloat(document.getElementById('power').value);
            const resultBox = document.getElementById('result');
            const t = translations[currentLang];

            let totalHours = 0;

            if (isNaN(power)) {
                resultBox.textContent = t.error;
                resultBox.classList.remove('hidden', 'text-green-600');
                resultBox.classList.add('text-red-600', 'fade-in-up');
                return;
            }

            switch (currentTab) {
                case 'hm':
                    const hours = parseFloat(document.getElementById('hours').value) || 0;
                    const minutes = parseFloat(document.getElementById('minutes').value) || 0;
                    totalHours = hours + minutes / 60;
                    break;
                case 'days':
                    totalHours = (parseFloat(document.getElementById('days-input').value) || 0) * 24;
                    break;
                case 'months':
                    totalHours = (parseFloat(document.getElementById('months-input').value) || 0) * 30 * 24;
                    break;
                case 'years':
                    totalHours = (parseFloat(document.getElementById('years-input').value) || 0) * 365 * 24;
                    break;
            }

            if (totalHours <= 0) {
                resultBox.textContent = t.error;
                resultBox.classList.remove('hidden', 'text-green-600');
                resultBox.classList.add('text-red-600', 'fade-in-up');
                return;
            }

            const kwh = (power * totalHours) / 1000;
            const cost = calculateTariff(kwh);
            resultBox.innerHTML = `${t.result(kwh.toFixed(2))}<br><span class='text-blue-700'>ğŸ’¸ ${t.totalCost}: ${cost.toLocaleString()} IQD</span><div class='mt-2 text-xs text-gray-500'>${tariffDescriptions[currentLang]}</div>`;
            resultBox.classList.remove('hidden', 'text-red-600');
            resultBox.classList.add('text-green-600', 'fade-in-up');
        }

        function initListeners() {
            ['power', 'hours', 'minutes', 'days-input', 'months-input', 'years-input'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.addEventListener('input', calculateKwh);
            });
        }

        // Kurdistan residential tariff slabs
        const tariffSlabs = [
            { upTo: 400, rate: 72 },
            { upTo: 800, rate: 108 },
            { upTo: 1200, rate: 175 },
            { upTo: 1600, rate: 265 },
            { upTo: Infinity, rate: 350 }
        ];

        function calculateTariff(kwh) {
            let remaining = kwh;
            let total = 0;
            let prev = 0;
            for (const slab of tariffSlabs) {
                const slabKwh = Math.min(remaining, slab.upTo - prev);
                if (slabKwh > 0) {
                    total += slabKwh * slab.rate;
                    remaining -= slabKwh;
                }
                prev = slab.upTo;
                if (remaining <= 0) break;
            }
            return total;
        }

        function updateTariffInfo() {
            document.getElementById('tariff-info').innerHTML = tariffDescriptions[currentLang];
        }

        // Device scenario logic
        let devices = [];
        function addDevice() {
            const id = Date.now() + Math.random();
            devices.push({
                id,
                name: '',
                power: '',
                hours: '',
                days: 30,
                months: 1
            });
            renderDevices();
        }
        function removeDevice(id) {
            devices = devices.filter(d => d.id !== id);
            renderDevices();
        }
        function updateDevice(id, field, value) {
            const d = devices.find(dev => dev.id === id);
            if (d) { d[field] = value; renderDevices(); }
        }
        function renderDevices() {
            const list = document.getElementById('devices-list');
            list.innerHTML = '';
            let totalKwh = 0;
            let details = [];
            devices.forEach(dev => {
                const kwh = (parseFloat(dev.power) || 0) * (parseFloat(dev.hours) || 0) * (parseFloat(dev.days) || 0) * (parseFloat(dev.months) || 0) / 1000;
                totalKwh += kwh;
                details.push({ name: dev.name, kwh });
                list.innerHTML += `
                <div class="bg-gradient-to-r from-purple-50 to-pink-50 p-4 rounded-2xl shadow flex flex-col gap-2 border border-purple-100">
                    <div class="flex justify-between items-center gap-2 flex-wrap">
                        <input type="text" placeholder="${translations[currentLang].devicePlaceholder}" value="${dev.name}" onchange="updateDevice(${dev.id}, 'name', this.value)" class="flex-1 mr-2 p-2 rounded border border-gray-300 bg-white min-w-[120px]" />
                        <button onclick="removeDevice(${dev.id})" class="text-red-500 hover:text-red-700 text-xl px-2 py-1 rounded transition" title="${translations[currentLang].remove}">âœ–</button>
                    </div>
                    <div class="flex gap-2 flex-wrap">
                        <input type="number" placeholder="${translations[currentLang].powerPlaceholder}" value="${dev.power}" onchange="updateDevice(${dev.id}, 'power', this.value)" class="w-1/4 min-w-[80px] p-2 rounded border border-gray-300 bg-white" />
                        <input type="number" placeholder="${translations[currentLang].hoursPlaceholder}" value="${dev.hours}" onchange="updateDevice(${dev.id}, 'hours', this.value)" class="w-1/4 min-w-[80px] p-2 rounded border border-gray-300 bg-white" />
                        <input type="number" placeholder="${translations[currentLang].daysPlaceholder}" value="${dev.days}" onchange="updateDevice(${dev.id}, 'days', this.value)" class="w-1/4 min-w-[80px] p-2 rounded border border-gray-300 bg-white" />
                        <input type="number" placeholder="${translations[currentLang].monthsPlaceholder}" value="${dev.months}" onchange="updateDevice(${dev.id}, 'months', this.value)" class="w-1/4 min-w-[80px] p-2 rounded border border-gray-300 bg-white" />
                    </div>
                    <div class="text-sm text-gray-700">${translations[currentLang].kwhLabel}: <span class="font-bold">${kwh.toFixed(2)}</span></div>
                </div>`;
            });
            // Summary
            const totalCost = calculateTariff(totalKwh);
            let summary = devices.length ?
                `<div class="mt-2">${translations[currentLang].totalKwh}: <span class="font-bold">${totalKwh.toFixed(2)}</span></div>
                 <div>${translations[currentLang].totalCost}: <span class="font-bold">${totalCost.toLocaleString()} IQD</span></div>` : '';
            if (devices.length > 0) {
                summary += `<div class='mt-2 text-xs text-gray-500'>${tariffDescriptions[currentLang]}</div>`;
                summary += `<div class='mt-2 text-xs text-gray-700'>`;
                details.forEach(d => {
                    summary += `<div>${d.name ? d.name + ': ' : ''}${d.kwh.toFixed(2)} kWh</div>`;
                });
                summary += `</div>`;
            }
            document.getElementById('devices-summary').innerHTML = summary;
        }

        window.addEventListener('resize', () => {
            if (window.innerWidth < 700) {
                document.getElementById('container').classList.remove('flex-row');
                document.getElementById('container').classList.add('flex-col');
            } else {
                document.getElementById('container').classList.remove('flex-col');
                document.getElementById('container').classList.add('flex-row');
            }
        });

        initListeners();
        applyTranslation();
        updateLangSelect();
        renderDevices();
    </script>
</body>

</html>